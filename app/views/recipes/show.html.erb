<% provide :title, @recipe.name %>

<div class="header">
  <h2><%= @recipe.name %></h2>
  <h4><%= @recipe.style %></h4>

  <p>By <%= link_to @recipe.user.name, @recipe.user %></p>
</div>

<div>
  <table>
    <tr><td><h3>Malt</h3></td></tr>
    <% @recipe.malts.each do |malt| %>
      <tr><td><%= malt.name %></td><td><%= malt.quantity %></td></tr>
    <% end %>
    <tr><td><h3>Hops</h3></td></tr>
    <% @recipe.hops.each do |hop| %>
      <tr><td><%= hop.name %></td><td><%= hop.quantity %></td></tr>
    <% end %>
    <tr><td><h3>Yeast</h3></td></tr>
    <% @recipe.yeasts.each do |yeast| %>
      <tr><td><%= yeast.name %></td></tr>
    <% end %>
  </table>

</div>

<p>
  <strong>Method:</strong>
  <%= @recipe.method %>
</p>

<%= link_to 'Edit', edit_recipe_path(@recipe) if @recipe.user == @current_user %>

<h4>
  <span>Community Rating:</span>
  <span class="aggregate-rating"><%= get_aggregate_rating(@recipe) %><span>
</h4>

<% if(logged_in? && @current_user != @recipe.user) %>
  <% rated?(@current_user, @recipe) ? rating = get_user_rating(@current_user, @recipe) : rating = 0 %>
  <h4>
    <span>Your rating:</span>
    <span class="user-rating"><%= rating %></span>
  </h4>

  <input id="user-rating"></input>
  <button class="rating-btn btn btn-primary" type="button">Update Rating</button>
<% end %>
